# Mini SOC on AWS (SIEM & SOAR)

This project implements a mini Security Operations Center (SOC) in the AWS Cloud (Region: `eu-west-3`) using Industry-standard tools for detection, response, and automation.

## üèó Architecture

```mermaid
graph TD
    subgraph "AWS VPC (10.0.0.0/16)"
        subgraph "Public Subnet (10.0.1.0/24)"
            direction TB
            Wazuh["Wazuh Manager (SIEM/XDR)<br/>m7i-flex.large (150GB)"]
            Shuffle["Shuffle (SOAR)<br/>m7i-flex.large (150GB)"]
            Suricata["Suricata (NIDS)<br/>(Installed on Wazuh Host)"]
        end

        subgraph "Clients Subnet"
            LinuxWeb["Linux Web Server<br/>(Apache)<br/>m7i-flex.large (50GB)"]
            LinuxFTP["Linux FTP Server<br/>(vsftpd)<br/>m7i-flex.large (50GB)"]
            WinWeb["Windows Web Server<br/>(IIS)<br/>m7i-flex.large (50GB)"]
        end
    end

    Internet((Internet)) <--> IGW[Internet Gateway]
    IGW <--> Wazuh
    IGW <--> Shuffle
    IGW <--> LinuxWeb
    IGW <--> WinWeb

    LinuxWeb -- "Wazuh Agent (logs/alerts)" --> Wazuh
    LinuxFTP -- "Wazuh Agent (logs/alerts)" --> Wazuh
    WinWeb -- "Wazuh Agent (logs/alerts)" --> Wazuh

    Wazuh -- "Alerts (Webhook)" --> Shuffle
    Shuffle -- "API Call (Block IP)" --> AWS_SG["AWS Security Group"]
```

## üõ† Project Components

- **SIEM**: [Wazuh](https://wazuh.com/) (HIDS/XDR) for log analysis, file integrity monitoring, and vulnerability detection.
- **NIDS**: [Suricata](https://suricata.io/) for network-based threat detection.
- **SOAR**: [Shuffle](https://shuffler.io/) for automated incident response workflows.
- **Cloud Infrastructure**: [Terraform](https://www.terraform.io/) for AWS provisioning.
- **Configuration Management**: [Ansible](https://www.ansible.com/) for automated software installation.

## üöÄ Getting Started

### 1. Infrastructure Deployment
Navigate to the `terraform/` directory and apply the configuration:
```bash
cd terraform
terraform init
terraform apply
```

### 2. Configuration
Update the `ansible/inventory.ini` with the IPs generated by Terraform, then run the playbooks:
```bash
# Setup SOC Components
ansible-playbook -i ansible/inventory.ini ansible/playbooks/setup_wazuh.yml
ansible-playbook -i ansible/inventory.ini ansible/playbooks/setup_shuffle.yml
ansible-playbook -i ansible/inventory.ini ansible/playbooks/setup_suricata.yml

# Setup Clients
ansible-playbook -i ansible/inventory.ini ansible/playbooks/setup_clients.yml
```

### 3. Attack Simulation
Use the provided script to test detection:
```bash
./scenarios/attack_simulation.sh <CLIENT_IP>
```

## üõ° Security Note
- Default region: `eu-west-3`
- Default Instance Type: `m7i-flex.large`
- Ensure you have the `soc-key` keypair in your AWS account before running Terraform.